var dnd=dnd||{};!function(){"use strict";dnd.ajax=function(e,n,d){var t=new XMLHttpRequest;t.open("GET",e,!0),t.onload=function(){t.status>=200&&t.status<400?n(t.responseText):d()},t.onerror=function(){d()},t.send()},dnd.selector=function(e,n){if(e=e.trim(),n||(n=document),e.indexOf(" ")===-1){if(0===e.lastIndexOf("."))return n.getElementsByClassName(e.substring(1));if(0===e.lastIndexOf("#"))return n.getElementById(e.substring(1))}return n.querySelectorAll(e)},dnd.replaceAll=function(e,n,d){return e.replace(new RegExp(n,"g"),d)},dnd.appendTo=function(e,n){e.insertAdjacentHTML("beforeend",n)},dnd.addEventHandler=function(e,n,d){e.addEventListener?e.addEventListener(n,d,!1):e.attachEvent&&e.attachEvent("on"+n,d)}}();var dnd=dnd||{};!function(){"use strict";dnd.vars=dnd.vars||{},dnd.service=dnd.service||{},dnd.templates=function(){n(".-js-template--"+dnd.menu,"#template--"+dnd.menu,dnd.service[dnd.menu],!0)};var e=function(e){var n=dnd.selector(e);n.length>0&&(n[0].innerHTML="")},n=function(n,d,t,a){a&&e(n);var r=dnd.selector(d),o=dnd.selector(n);if(null!=r&&o.length>0){var l=r.innerHTML,i=t,s=0;null!=i&&i.forEach(function(e,n){if(s<dnd.filters.amount){var d=l,t=1==e.prestige,a=1==e.verbal_component,r=1==e.somatic_component,i=1==e.arcane_focus_component,c=1==e.divine_focus_component,f=1==e.xp_component;d=dnd.replaceAll(d,"#ID#",e.itemid),d=dnd.replaceAll(d,"#NAME#",e.name),d=dnd.replaceAll(d,"#ALIAS#",e.slug),d=dnd.replaceAll(d,"#DESCRIPTION#",e.description),d=dnd.replaceAll(d,"#PRESTIGE#",t),d=dnd.replaceAll(d,"#SPELLSCHOOL#",e.spellschool_name),d=dnd.replaceAll(d,"#COMPONENTVERBAL#",a),d=dnd.replaceAll(d,"#COMPONENTSOMATIC#",r),d=dnd.replaceAll(d,"#COMPONENTARCANE#",i),d=dnd.replaceAll(d,"#COMPONENTDIVINE#",c),d=dnd.replaceAll(d,"#COMPONENTXP#",f),d=dnd.replaceAll(d,"#BOOK#",e.rulebook_name),d=dnd.replaceAll(d,"#EDITION#",e.edition_name),d=dnd.replaceAll(d,"#EDITIONURL#","/edition/"+e.edition_id),d=dnd.replaceAll(d,"#CURRENTURL#","/"+dnd.menu+"/"+e.itemid),d=dnd.replaceAll(d,"#URL#","/rulebook/"+e.rulebook_slug),dnd.appendTo(o[0],d),s++}})}}}();var dnd=dnd||{};!function(){"use strict";dnd.vars=dnd.vars||{},dnd.service=dnd.service||{},dnd.filters=function(){if(dnd.filters.amount=25,dnd.vars.localStorage){localStorage.getItem("filter-amount");null==localStorage.getItem("filter-amount")?localStorage.setItem("filter-amount",dnd.filters.amount):dnd.filters.amount=parseInt(localStorage.getItem("filter-amount"))}for(var e=dnd.selector(".-js-sorting-amount"),n=0;n<e.length;n++){for(var d=e[n],t=d.options,a=0;a<t.length;a++){var r=t[a];r.value==dnd.filters.amount.toString()&&(d.selectedIndex=a)}d.addEventListener("change",function(){var n=this.options[this.selectedIndex].value;dnd.filters.amount=parseInt(n),dnd.vars.localStorage&&dnd.filters.amount<=100&&localStorage.setItem("filter-amount",dnd.filters.amount),o(e,n),dnd.templates()})}var o=function(e,n){for(var d=0;d<e.length;d++)for(var t=e[d],a=t.options,r=0;r<a.length;r++){var o=a[r];o.value==n.toString()&&(t.selectedIndex=r)}}}}();var dnd=dnd||{};!function(){"use strict";dnd.vars=dnd.vars||{},dnd.service=dnd.service||{};var e="http://138.68.114.21",n=function(){console.log("Error loading data")},d=function(d,t){dnd.ajax(e+"/endpoints",function(r){var o=0,l=0;dnd.service.endpoints=JSON.parse(r),d&&localStorage.setItem("endpoints",r),dnd.service.endpoints.forEach(function(e,n){e.path.indexOf(":id")==-1&&e.path.indexOf(":rid")==-1&&e.path.indexOf(":sid")==-1&&o++}),dnd.service.endpoints.forEach(function(r,i){r.path.indexOf(":id")==-1&&r.path.indexOf(":rid")==-1&&r.path.indexOf(":sid")==-1&&dnd.ajax(e+r.path,function(e){l++,dnd.service[""+r.alias]=JSON.parse(e),d&&localStorage.setItem(r.alias,JSON.stringify(e)),l==o&&a(t)},function(){n()},function(){n()})})},function(){n()},function(){n()})},t=function(e){if(dnd.vars.hasLocalStorage&&0==localStorage.length)d(!0,e);else if(dnd.vars.hasLocalStorage){var n=0;JSON.parse(localStorage.getItem("endpoints")).forEach(function(d,t){if(n++,d.path.indexOf(":id")==-1&&d.path.indexOf(":rid")==-1&&d.path.indexOf(":sid")==-1){var r=localStorage.getItem(d.alias);dnd.service[""+d.alias]=JSON.parse(JSON.parse(r))}n==JSON.parse(localStorage.getItem("endpoints")).length&&a(e)})}else d(!1,e)},a=function(e){var n=dnd.selector("#Loader");n.classList.add("is-hidden"),e()};dnd.initService=function(e){var n=dnd.selector("#Loader");dnd.database?t(e):n.style.display="none"}}();var dnd=dnd||{};!function(){dnd.vars=dnd.vars||{},dnd.service=dnd.service||{},"undefined"!=typeof Storage?dnd.vars.hasLocalStorage=!0:dnd.vars.hasLocalStorage=!1;var e=dnd.selector("#Header");setTimeout(function(){e.classList.add("is-shown")},1),dnd.dataLoaded=function(){dnd.filters(),dnd.templates()},dnd.initService(dnd.dataLoaded)}();